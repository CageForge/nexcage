
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Next-generation container runtime for Proxmox VE using LXC and OCI backends">
      
      
      
        <link rel="canonical" href="https://cageforge.github.io/nexcage/v0.7.3/MODULAR_ARCHITECTURE/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Modular Architecture Guide - NexCage Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modular-architecture-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NexCage Docs" class="md-header__button md-logo" aria-label="NexCage Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NexCage Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modular Architecture Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CageForge/nexcage" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CageForge/nexcage
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../versions.md" class="md-tabs__link">
        
  
  
    
  
  Versions

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../INSTALL/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../user_guide/" class="md-tabs__link">
        
  
  
    
  
  User Guide

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../architecture/OVERVIEW/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../CI_CD_SETUP/" class="md-tabs__link">
        
  
  
    
  
  CI/CD

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../DEPENDENCIES/" class="md-tabs__link">
        
  
  
    
  
  Dependencies

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../PROXMOX_TESTING.md" class="md-tabs__link">
        
  
  
    
  
  Proxmox Testing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NexCage Docs" class="md-nav__button md-logo" aria-label="NexCage Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NexCage Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CageForge/nexcage" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    CageForge/nexcage
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../versions.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versions
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../INSTALL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEV_QUICKSTART/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dev Quickstart
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEVELOPMENT_WORKFLOW/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Workflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEVELOPMENT_UBUNTU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ubuntu Dev Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/OVERVIEW/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CI_CD_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI/CD
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../DEPENDENCIES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dependencies
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../PROXMOX_TESTING.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proxmox Testing
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Principles
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture Principles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solid-principles" class="md-nav__link">
    <span class="md-ellipsis">
      SOLID Principles
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Module Structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-module" class="md-nav__link">
    <span class="md-ellipsis">
      Core Module
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-management" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-system" class="md-nav__link">
    <span class="md-ellipsis">
      Logging System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backend-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Backend Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Backend Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lxc-backend" class="md-nav__link">
    <span class="md-ellipsis">
      LXC Backend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxmox-lxc-backend" class="md-nav__link">
    <span class="md-ellipsis">
      Proxmox LXC Backend
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-module" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Module
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLI Module">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-registration" class="md-nav__link">
    <span class="md-ellipsis">
      Command Registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Commands
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proxmox-api-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Proxmox API Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zfs-integration" class="md-nav__link">
    <span class="md-ellipsis">
      ZFS Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-container-management" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Container Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxmox-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Proxmox Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#memory-management" class="md-nav__link">
    <span class="md-ellipsis">
      Memory Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling_1" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-design" class="md-nav__link">
    <span class="md-ellipsis">
      Module Design
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-from-legacy" class="md-nav__link">
    <span class="md-ellipsis">
      Migration from Legacy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-tips" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Tips
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Future Extensions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/CageForge/nexcage/edit/master/docs/MODULAR_ARCHITECTURE.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="modular-architecture-guide">Modular Architecture Guide<a class="headerlink" href="#modular-architecture-guide" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>Nexcage v0.4.0 introduces a modular architecture that follows SOLID principles, providing clean separation of concerns and extensibility.</p>
<h2 id="architecture-principles">Architecture Principles<a class="headerlink" href="#architecture-principles" title="Permanent link">&para;</a></h2>
<h3 id="solid-principles">SOLID Principles<a class="headerlink" href="#solid-principles" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Single Responsibility Principle (SRP)</strong>: Each module has a single, well-defined responsibility</li>
<li><strong>Open/Closed Principle (OCP)</strong>: Modules are open for extension but closed for modification</li>
<li><strong>Liskov Substitution Principle (LSP)</strong>: Backends and integrations are interchangeable through common interfaces</li>
<li><strong>Interface Segregation Principle (ISP)</strong>: Interfaces are focused and specific</li>
<li><strong>Dependency Inversion Principle (DIP)</strong>: Core depends on abstractions, not concrete implementations</li>
</ol>
<h2 id="module-structure">Module Structure<a class="headerlink" href="#module-structure" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="nx">src</span><span class="o">/</span>
<span class="err">├──</span><span class="w"> </span><span class="nx">core</span><span class="o">/</span><span class="w">           </span><span class="err">#</span><span class="w"> </span><span class="nx">System</span><span class="w"> </span><span class="nx">core</span><span class="w"> </span><span class="p">(</span><span class="nx">required</span><span class="w"> </span><span class="nx">modules</span><span class="p">)</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">config</span><span class="p">.</span><span class="nx">zig</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="nx">Global</span><span class="w"> </span><span class="nx">configuration</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">errors</span><span class="p">.</span><span class="nx">zig</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="nx">Error</span><span class="w"> </span><span class="nx">handling</span><span class="w"> </span><span class="nx">system</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">logging</span><span class="p">.</span><span class="nx">zig</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="nx">Structured</span><span class="w"> </span><span class="nx">logging</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">interfaces</span><span class="p">.</span><span class="nx">zig</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nx">Common</span><span class="w"> </span><span class="nx">interfaces</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="nx">types</span><span class="p">.</span><span class="nx">zig</span><span class="w">       </span><span class="err">#</span><span class="w"> </span><span class="nx">Global</span><span class="w"> </span><span class="nx">types</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">structures</span>
<span class="err">├──</span><span class="w"> </span><span class="nx">backends</span><span class="o">/</span><span class="w">       </span><span class="err">#</span><span class="w"> </span><span class="nx">Backend</span><span class="w"> </span><span class="nx">implementations</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">lxc</span><span class="o">/</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nx">LXC</span><span class="w"> </span><span class="nx">backend</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">proxmox</span><span class="o">-</span><span class="nx">lxc</span><span class="o">/</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">LXC</span><span class="w"> </span><span class="nx">backend</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">proxmox</span><span class="o">-</span><span class="nx">vm</span><span class="o">/</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">VM</span><span class="w"> </span><span class="nx">backend</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="nx">crun</span><span class="o">/</span><span class="w">           </span><span class="err">#</span><span class="w"> </span><span class="nx">Crun</span><span class="w"> </span><span class="nx">OCI</span><span class="w"> </span><span class="nx">backend</span>
<span class="err">├──</span><span class="w"> </span><span class="nx">integrations</span><span class="o">/</span><span class="w">   </span><span class="err">#</span><span class="w"> </span><span class="nx">External</span><span class="w"> </span><span class="nx">system</span><span class="w"> </span><span class="nx">integrations</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">proxmox</span><span class="o">-</span><span class="kn">api</span><span class="o">/</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">API</span><span class="w"> </span><span class="nx">client</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">zfs</span><span class="o">/</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nx">ZFS</span><span class="w"> </span><span class="nx">integration</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="nx">bfc</span><span class="o">/</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nx">BFC</span><span class="w"> </span><span class="nx">integration</span>
<span class="err">├──</span><span class="w"> </span><span class="nx">cli</span><span class="o">/</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nx">Command</span><span class="o">-</span><span class="nx">line</span><span class="w"> </span><span class="kd">interface</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">run</span><span class="p">.</span><span class="nx">zig</span><span class="w">         </span><span class="err">#</span><span class="w"> </span><span class="nx">Run</span><span class="w"> </span><span class="nx">command</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">help</span><span class="p">.</span><span class="nx">zig</span><span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nx">Help</span><span class="w"> </span><span class="nx">command</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">version</span><span class="p">.</span><span class="nx">zig</span><span class="w">     </span><span class="err">#</span><span class="w"> </span><span class="nx">Version</span><span class="w"> </span><span class="nx">command</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="nx">registry</span><span class="p">.</span><span class="nx">zig</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="nx">registry</span>
<span class="err">├──</span><span class="w"> </span><span class="nx">utils</span><span class="o">/</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="nx">Utility</span><span class="w"> </span><span class="nx">modules</span>
<span class="err">│</span><span class="w">   </span><span class="err">├──</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">zig</span><span class="w">          </span><span class="err">#</span><span class="w"> </span><span class="nx">File</span><span class="w"> </span><span class="nx">system</span><span class="w"> </span><span class="nx">utilities</span>
<span class="err">│</span><span class="w">   </span><span class="err">└──</span><span class="w"> </span><span class="nx">net</span><span class="p">.</span><span class="nx">zig</span><span class="w">         </span><span class="err">#</span><span class="w"> </span><span class="nx">Network</span><span class="w"> </span><span class="nx">utilities</span>
<span class="err">└──</span><span class="w"> </span><span class="nx">main_modular</span><span class="p">.</span><span class="nx">zig</span><span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nx">Modular</span><span class="w"> </span><span class="nx">entry</span><span class="w"> </span><span class="nx">point</span>
</code></pre></div>

<h2 id="core-module">Core Module<a class="headerlink" href="#core-module" title="Permanent link">&para;</a></h2>
<p>The core module provides the foundation for all other modules:</p>
<h3 id="configuration-management">Configuration Management<a class="headerlink" href="#configuration-management" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;core&quot;</span><span class="p">);</span>

<span class="c1">// Initialize configuration loader</span>
<span class="kr">var</span><span class="w"> </span><span class="n">config_loader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">ConfigLoader</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">);</span>
<span class="kr">const</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">config_loader</span><span class="p">.</span><span class="n">loadDefault</span><span class="p">();</span>

<span class="c1">// Access configuration</span>
<span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Runtime type: {}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="n">config</span><span class="p">.</span><span class="n">runtime_type</span><span class="p">});</span>
</code></pre></div>

<h3 id="logging-system">Logging System<a class="headerlink" href="#logging-system" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Initialize logger</span>
<span class="kr">var</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">LogContext</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">getStdErr</span><span class="p">().</span><span class="n">writer</span><span class="p">(),</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">LogLevel</span><span class="p">.</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my-app&quot;</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="c1">// Log messages</span>
<span class="k">try</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Application started&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>
<span class="k">try</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="err">@</span><span class="s">&quot;error&quot;</span><span class="p">(</span><span class="s">&quot;Operation failed: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="k">error</span><span class="p">});</span>
</code></pre></div>

<h3 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Use core error types</span>
<span class="k">return</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">Error</span><span class="p">.</span><span class="n">InvalidInput</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">Error</span><span class="p">.</span><span class="n">RuntimeError</span><span class="p">;</span>
</code></pre></div>

<h2 id="backend-modules">Backend Modules<a class="headerlink" href="#backend-modules" title="Permanent link">&para;</a></h2>
<p>Backends implement the container runtime interfaces defined in <code>core/interfaces.zig</code>.</p>
<h3 id="lxc-backend">LXC Backend<a class="headerlink" href="#lxc-backend" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">backends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;backends&quot;</span><span class="p">);</span>

<span class="c1">// Initialize LXC backend</span>
<span class="kr">const</span><span class="w"> </span><span class="n">lxc_driver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">backends</span><span class="p">.</span><span class="n">lxc</span><span class="p">.</span><span class="n">LxcDriver</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">sandbox_config</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="c1">// Create container</span>
<span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">sandbox_config</span><span class="p">);</span>

<span class="c1">// Start container</span>
<span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">&quot;container-id&quot;</span><span class="p">);</span>

<span class="c1">// Stop container</span>
<span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">&quot;container-id&quot;</span><span class="p">);</span>
</code></pre></div>

<h3 id="proxmox-lxc-backend">Proxmox LXC Backend<a class="headerlink" href="#proxmox-lxc-backend" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Initialize Proxmox LXC backend</span>
<span class="kr">const</span><span class="w"> </span><span class="n">proxmox_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">ProxmoxLxcBackendConfig</span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proxmox.example.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8006</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;user@pam&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;password&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pam&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">verify_ssl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">const</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">backends</span><span class="p">.</span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">ProxmoxLxcDriver</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">proxmox_config</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="c1">// Create LXC container via Proxmox API</span>
<span class="kr">const</span><span class="w"> </span><span class="n">lxc_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">ProxmoxLxcConfig</span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">vmid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">hostname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;test-container&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">512</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">cores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">rootfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;local-lvm:8&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">try</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">createContainer</span><span class="p">(</span><span class="n">lxc_config</span><span class="p">);</span>
</code></pre></div>

<h2 id="cli-module">CLI Module<a class="headerlink" href="#cli-module" title="Permanent link">&para;</a></h2>
<p>The CLI module provides a registry-based command system:</p>
<h3 id="command-registration">Command Registration<a class="headerlink" href="#command-registration" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">cli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;cli&quot;</span><span class="p">);</span>

<span class="c1">// Initialize command registry</span>
<span class="kr">var</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cli</span><span class="p">.</span><span class="n">CommandRegistry</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="c1">// Register built-in commands</span>
<span class="k">try</span><span class="w"> </span><span class="n">cli</span><span class="p">.</span><span class="n">registerBuiltinCommands</span><span class="p">(</span><span class="o">&amp;</span><span class="n">registry</span><span class="p">);</span>

<span class="c1">// List available commands</span>
<span class="kr">const</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="n">list</span><span class="p">(</span><span class="n">allocator</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">free</span><span class="p">(</span><span class="n">commands</span><span class="p">);</span>
</code></pre></div>

<h3 id="custom-commands">Custom Commands<a class="headerlink" href="#custom-commands" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Create custom command</span>
<span class="kr">const</span><span class="w"> </span><span class="n">MyCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@This</span><span class="p">();</span>

<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mycommand&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">description</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="kr">const</span><span class="w"> </span><span class="kt">u8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;My custom command&quot;</span><span class="p">,</span>

<span class="w">    </span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="n">Self</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="o">:</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">RuntimeOptions</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="o">:</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">mem</span><span class="p">.</span><span class="n">Allocator</span><span class="p">)</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">;</span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">;</span>

<span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Executing custom command</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Register custom command</span>
<span class="kr">const</span><span class="w"> </span><span class="n">my_cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="n">allocator</span><span class="p">.</span><span class="n">alloc</span><span class="p">(</span><span class="n">MyCommand</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="n">my_cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyCommand</span><span class="p">{};</span>
<span class="k">try</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="nb">@ptrCast</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_cmd</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
</code></pre></div>

<h2 id="integration-modules">Integration Modules<a class="headerlink" href="#integration-modules" title="Permanent link">&para;</a></h2>
<p>Integration modules provide external system connectivity:</p>
<h3 id="proxmox-api-integration">Proxmox API Integration<a class="headerlink" href="#proxmox-api-integration" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">integrations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;integrations&quot;</span><span class="p">);</span>

<span class="c1">// Initialize Proxmox API client</span>
<span class="kr">const</span><span class="w"> </span><span class="n">api_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">ProxmoxApiConfig</span><span class="p">{</span>
<span class="w">    </span><span class="p">.</span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proxmox.example.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8006</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;user@pam!tokenid=tokenvalue&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">.</span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;node1&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="kr">const</span><span class="w"> </span><span class="n">api_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">integrations</span><span class="p">.</span><span class="n">proxmox_api</span><span class="p">.</span><span class="n">ProxmoxApiClient</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">api_config</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">api_client</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="c1">// Make API requests</span>
<span class="kr">const</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">api_client</span><span class="p">.</span><span class="n">makeRequest</span><span class="p">(.</span><span class="n">GET</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/api2/json/cluster/status&quot;</span><span class="p">);</span>
</code></pre></div>

<h3 id="zfs-integration">ZFS Integration<a class="headerlink" href="#zfs-integration" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1">// Initialize ZFS client</span>
<span class="kr">const</span><span class="w"> </span><span class="n">zfs_client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">integrations</span><span class="p">.</span><span class="n">zfs</span><span class="p">.</span><span class="n">ZfsClient</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">);</span>
<span class="k">defer</span><span class="w"> </span><span class="n">zfs_client</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="c1">// Create ZFS dataset</span>
<span class="k">try</span><span class="w"> </span><span class="n">zfs_client</span><span class="p">.</span><span class="n">createDataset</span><span class="p">(</span><span class="s">&quot;tank/containers&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>

<span class="c1">// Create snapshot</span>
<span class="k">try</span><span class="w"> </span><span class="n">zfs_client</span><span class="p">.</span><span class="n">createSnapshot</span><span class="p">(</span><span class="s">&quot;tank/containers@backup&quot;</span><span class="p">);</span>
</code></pre></div>

<h2 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">&para;</a></h2>
<h3 id="basic-container-management">Basic Container Management<a class="headerlink" href="#basic-container-management" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<span class="kr">const</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;core&quot;</span><span class="p">);</span>
<span class="kr">const</span><span class="w"> </span><span class="n">backends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;backends&quot;</span><span class="p">);</span>

<span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">heap</span><span class="p">.</span><span class="n">GeneralPurposeAllocator</span><span class="p">(.{}){};</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpa</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpa</span><span class="p">.</span><span class="n">allocator</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Initialize logger</span>
<span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">LogContext</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">getStdErr</span><span class="p">().</span><span class="n">writer</span><span class="p">(),</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">LogLevel</span><span class="p">.</span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;container-manager&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Initialize LXC backend</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">sandbox_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">SandboxConfig</span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my-container&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">runtime_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">lxc</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">lxc_driver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">backends</span><span class="p">.</span><span class="n">lxc</span><span class="p">.</span><span class="n">LxcDriver</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">sandbox_config</span><span class="p">);</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Set logger</span>
<span class="w">    </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">setLogger</span><span class="p">(</span><span class="o">&amp;</span><span class="n">logger</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Create container</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">sandbox_config</span><span class="p">);</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Container created successfully&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>

<span class="w">    </span><span class="c1">// Start container</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">&quot;my-container&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Container started successfully&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>

<span class="w">    </span><span class="c1">// Get container info</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;my-container&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">allocator</span><span class="p">);</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Container state: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="n">info</span><span class="p">.</span><span class="n">state</span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Stop container</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">lxc_driver</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">&quot;my-container&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Container stopped successfully&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="proxmox-integration">Proxmox Integration<a class="headerlink" href="#proxmox-integration" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;std&quot;</span><span class="p">);</span>
<span class="kr">const</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;core&quot;</span><span class="p">);</span>
<span class="kr">const</span><span class="w"> </span><span class="n">backends</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&quot;backends&quot;</span><span class="p">);</span>

<span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="o">!</span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">var</span><span class="w"> </span><span class="n">gpa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">heap</span><span class="p">.</span><span class="n">GeneralPurposeAllocator</span><span class="p">(.{}){};</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpa</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpa</span><span class="p">.</span><span class="n">allocator</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Initialize Proxmox LXC backend</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">proxmox_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">ProxmoxLxcBackendConfig</span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;proxmox.example.com&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8006</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;user@pam&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;password&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pam&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">verify_ssl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">backends</span><span class="p">.</span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">ProxmoxLxcDriver</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="n">proxmox_config</span><span class="p">);</span>
<span class="w">    </span><span class="k">defer</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Create LXC container</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">lxc_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">core</span><span class="p">.</span><span class="n">types</span><span class="p">.</span><span class="n">ProxmoxLxcConfig</span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">allocator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allocator</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">vmid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">hostname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;proxmox-container&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">memory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">cores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">rootfs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;local-lvm:10&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">net0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bridge=vmbr0&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">ostemplate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">allocator</span><span class="p">.</span><span class="n">dupe</span><span class="p">(</span><span class="kt">u8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;local:vztmpl/ubuntu-20.04-standard_20.04-1_amd64.tar.zst&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">createContainer</span><span class="p">(</span><span class="n">lxc_config</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Proxmox LXC container created successfully</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>

<span class="w">    </span><span class="c1">// Start container</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">startContainer</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Container started successfully</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{});</span>

<span class="w">    </span><span class="c1">// Get container info</span>
<span class="w">    </span><span class="kr">const</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">proxmox_lxc</span><span class="p">.</span><span class="n">getContainerInfo</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="n">container_info</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="p">.</span><span class="n">debug</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Container info: VMID={d}, Status={s}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.{</span><span class="w"> </span><span class="n">container_info</span><span class="p">.</span><span class="n">vmid</span><span class="p">,</span><span class="w"> </span><span class="n">container_info</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="memory-management">Memory Management<a class="headerlink" href="#memory-management" title="Permanent link">&para;</a></h3>
<ul>
<li>Always use the provided allocator</li>
<li>Free allocated memory properly</li>
<li>Use defer statements for cleanup</li>
</ul>
<h3 id="error-handling_1">Error Handling<a class="headerlink" href="#error-handling_1" title="Permanent link">&para;</a></h3>
<ul>
<li>Use core error types consistently</li>
<li>Provide meaningful error messages</li>
<li>Handle errors gracefully</li>
</ul>
<h3 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h3>
<ul>
<li>Use structured logging with appropriate levels</li>
<li>Include context in log messages</li>
<li>Avoid logging sensitive information</li>
</ul>
<h3 id="module-design">Module Design<a class="headerlink" href="#module-design" title="Permanent link">&para;</a></h3>
<ul>
<li>Keep modules focused and cohesive</li>
<li>Minimize dependencies between modules</li>
<li>Use interfaces for loose coupling</li>
</ul>
<h2 id="migration-from-legacy">Migration from Legacy<a class="headerlink" href="#migration-from-legacy" title="Permanent link">&para;</a></h2>
<p>The modular architecture is designed to be backward compatible. To migrate from the legacy version:</p>
<ol>
<li>Update imports to use modular paths</li>
<li>Use the new configuration system</li>
<li>Leverage the new logging system</li>
<li>Take advantage of the registry-based CLI</li>
</ol>
<h2 id="performance-considerations">Performance Considerations<a class="headerlink" href="#performance-considerations" title="Permanent link">&para;</a></h2>
<ul>
<li>Modules are loaded on-demand</li>
<li>Memory usage is optimized through proper allocation patterns</li>
<li>Command execution is streamlined through the registry system</li>
<li>Backend selection is efficient and cached</li>
</ul>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="common-issues">Common Issues<a class="headerlink" href="#common-issues" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Allocator Errors</strong>: Ensure proper allocator usage and memory cleanup</li>
<li><strong>Module Import Errors</strong>: Check module paths and dependencies</li>
<li><strong>Command Not Found</strong>: Verify command registration in the registry</li>
<li><strong>Backend Initialization Failed</strong>: Check configuration parameters</li>
</ol>
<h3 id="debug-tips">Debug Tips<a class="headerlink" href="#debug-tips" title="Permanent link">&para;</a></h3>
<ul>
<li>Enable debug logging for detailed information</li>
<li>Use the built-in error handling system</li>
<li>Check module dependencies and imports</li>
<li>Validate configuration parameters</li>
</ul>
<h2 id="future-extensions">Future Extensions<a class="headerlink" href="#future-extensions" title="Permanent link">&para;</a></h2>
<p>The modular architecture makes it easy to add:</p>
<ul>
<li>New backend implementations</li>
<li>Additional integration modules</li>
<li>Custom CLI commands</li>
<li>Performance monitoring modules</li>
<li>Security enhancement modules</li>
</ul>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>The modular architecture provides a solid foundation for Proxmox LXCRI, enabling clean code organization, easy extensibility, and maintainability. By following SOLID principles, the system remains flexible and robust while providing powerful container and VM management capabilities.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2025 CageForge
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.expand", "content.code.copy", "content.action.edit", "content.tabs.link", "navigation.top"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>