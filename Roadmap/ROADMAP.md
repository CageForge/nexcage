# Roadmap проекту Proxmox LXC CRI

## Поточний етап: POC (Proof of Concept)
Тривалість: 4 тижні
Прогрес: 65%
Витрачено часу: 96 годин
Очікуваний час до завершення: ~52 години

### Мета
Продемонструвати можливість інтеграції Proxmox LXC з Kubernetes через CRI та реалізувати базовий OCI-сумісний runtime.

### Очікуваний результат
- Базова реалізація CRI для комунікації з Kubernetes ✓
- Інтеграція з Proxmox API для управління LXC контейнерами ✓
- Відповідність специфікації OCI для контейнерів ✓
- Успішний запуск LXC контейнера як Pod через CRI-O (в процесі, 80%)

### Виконані завдання
1. Налаштування базової структури проекту ✓ (16 годин)
   - Ініціалізація Zig проекту ✓
   - Налаштування середовища розробки ✓
   - Конфігурація системи збірки ✓
   - Налаштування CI/CD ✓
2. Реалізація базових операцій з контейнерами ✓ (24 години)
   - Створення ✓
   - Видалення ✓
   - Запуск ✓
   - Зупинка ✓
   - Отримання статусу ✓
3. Реалізація gRPC сервера для CRI ✓ (20 годин)
4. Реалізація тестів для основних операцій ✓ (12 годин)
   - Тести базових операцій з контейнерами ✓
   - Тести gRPC взаємодії ✓
   - Тести обробки помилок ✓
5. Реалізація OCI-сумісного runtime ✓ (16 годин)
   - Створення специфікації контейнера ✓
   - Реалізація структур даних для OCI специфікації ✓
   - Реалізація білдера для створення специфікацій ✓
   - Тести для OCI специфікацій та білдера ✓
   - Реалізація структури Container та ContainerState ✓
   - Тести для Container та ContainerState ✓
6. Інтеграція з Proxmox API ✓ (8 годин)
   - Базова реалізація клієнта ✓
   - Автентифікація та авторизація ✓
   - Базові операції з LXC ✓
   - Обробка помилок ✓
   
### Поточні завдання (Залишилось ~52 години)
1. Оптимізація та рефакторинг CRI/OCI реалізації (20 годин):
   - Створення спільного інтерфейсу для CRI та OCI runtime (70% готово)
   - Об'єднання дубльованої функціональності контейнерів (80% готово)
   - Розділення відповідальності між компонентами (60% готово)
   - Створення єдиного інтерфейсу для роботи з контейнерами (50% готово)
   - Винесення Proxmox-специфічного коду в окремий модуль (40% готово)
   - Написання тестів для нової архітектури (30% готово)

2. Завершення OCI-сумісного runtime (16 годин):
   - Інтеграція Container з основним рантаймом (90% готово)
   - Інтеграція з CRI-O (60% готово)
   - Реалізація хуків життєвого циклу (40% готово)

3. Розширення функціональності Proxmox API клієнта (16 годин):
   - Розширене управління ресурсами (50% готово)
   - Покращення обробки помилок (70% готово)
   - Розширені тести (30% готово)

### План рефакторингу
1. Етап 1: Створення спільного інтерфейсу (70% готово)
   - Визначення базового інтерфейсу для runtime ✓
   - Реалізація інтерфейсу для OCI ✓
   - Реалізація інтерфейсу для CRI (в процесі)
   - Тести для перевірки сумісності (в процесі)

2. Етап 2: Об'єднання функціональності контейнерів (80% готово)
   - Створення єдиної структури Container ✓
   - Міграція існуючого коду ✓
   - Оновлення залежних компонентів (в процесі)
   - Тести для контейнерів ✓

3. Етап 3: Розділення відповідальності (60% готово)
   - Створення окремого Proxmox модуля ✓
   - Перенесення специфічного коду (в процесі)
   - Створення абстракцій для платформо-залежного коду (в процесі)
   - Тести для Proxmox модуля (заплановано)

4. Етап 4: Фінальна інтеграція (40% готово)
   - Інтеграція всіх компонентів (в процесі)
   - Перевірка сумісності (заплановано)
   - Оптимізація продуктивності (заплановано)
   - Комплексні тести (заплановано)

### Майбутні завдання
1. Управління ресурсами:
   - CPU та пам'ять
   - Дисковий простір
   - Мережеві ресурси
2. Мережева конфігурація:
   - Управління мережевими інтерфейсами
   - Підтримка мережевих просторів імен
   - Політики мережі
3. Управління знімками:
   - Створення та відновлення
   - Управління версіями
   - Планування
4. Міграція контейнерів:
   - Жива міграція
   - Холодна міграція
   - Валідація та відкат
5. Управління шаблонами:
   - Створення та налаштування
   - Версіонування
   - Розповсюдження

## Наступні етапи

### POV (Proof of Value)
Тривалість: 3 тижні
- Оптимізація продуктивності
- Тестування під навантаженням
- Моніторинг та логування
- Безпека та ізоляція

### MVP (Minimum Viable Product)
Тривалість: 3 тижні
- Повна документація
- Інструменти для розгортання
- Підтримка мережевих політик
- Готовність до production

## Загальний прогрес проекту
- Прогрес: 65% (збільшено з 45% завдяки завершенню OCI runtime та значному прогресу в рефакторингу)
- Витрачено часу: 96 годин
- Очікуваний час до завершення POC: 52 години
- Очікуваний час до повного завершення проекту: 6 тижнів (зменшено на 2 тижні завдяки оптимізації архітектури та паралельній розробці)

### Ключові досягнення останнього етапу:
1. Завершено реалізацію базової структури Container та ContainerState
2. Значний прогрес у рефакторингу та оптимізації архітектури
3. Покращено інтеграцію з Proxmox API
4. Розширено тестове покриття

### Ризики та виклики:
1. Складність інтеграції з CRI-O може вимагати додаткового часу
2. Потенційні проблеми з продуктивністю при масштабуванні
3. Необхідність додаткового тестування безпеки та ізоляції 